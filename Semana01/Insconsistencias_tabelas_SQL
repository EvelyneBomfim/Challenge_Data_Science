/* RESOLVENDO INCONSISTÊNCIAS TABELA DADOS_MUTUARIOS*/

SELECT * FROM DADOS_MUTUARIOS;

-- Verificando se há dados nulos no campo PERSON_ID
SELECT PERSON_ID FROM DADOS_MUTUARIOS
WHERE PERSON_ID IS NULL;

-- Alterando coluna PERSON_ID para NOT NULL
ALTER TABLE DADOS_MUTUARIOS MODIFY PERSON_ID VARCHAR(16) NOT NULL;

-- Mesmo havendo apenas dados inteiros, o campo PERSON_INCOME refere-se a salário anual, o que poderia ser FLOAT
ALTER TABLE DADOS_MUTUARIOS MODIFY PERSON_INCOME FLOAT;

-- Verificando a coluna PERSON_EMP_LENGTH
SELECT * FROM DADOS_MUTUARIOS
GROUP BY PERSON_EMP_LENGTH ORDER BY PERSON_EMP_LENGTH;

-- A coluna PERSON_EMP_LENGTH, refere-se aos anos trabalhos, que são dados apenas inteiros (0 a 41.. 123)
-- Irei alterar o campo de DOUBLE para INT
ALTER TABLE DADOS_MUTUARIOS MODIFY PERSON_EMP_LENGTH INT;

-- Verificando se há dados duplicados para transformar coluna em chave-primária
SELECT PERSON_ID, COUNT(PERSON_ID) FROM DADOS_MUTUARIOS
GROUP BY PERSON_ID
HAVING COUNT(PERSON_ID)>1;

SELECT * FROM DADOS_MUTUARIOS
WHERE PERSON_ID='';

-- Criar 04 IDs para esses dados 'zerados'
UPDATE DADOS_MUTUARIOS SET PERSON_ID='zer4dos1-zd01'
WHERE PERSON_ID='' AND PERSON_AGE=25;

UPDATE DADOS_MUTUARIOS SET PERSON_ID='zer4dos2-zd02'
WHERE PERSON_ID='' AND PERSON_AGE=32;

UPDATE DADOS_MUTUARIOS SET PERSON_ID='zer4dos3-zd03'
WHERE PERSON_ID='' AND PERSON_INCOME=35100 AND PERSON_EMP_LENGTH=1;

UPDATE DADOS_MUTUARIOS SET PERSON_ID='zer4dos4-zd04'
WHERE PERSON_ID='' AND PERSON_AGE=28;


-- Adicionar PRIMARY KEY nas tabelas
ALTER TABLE DADOS_MUTUARIOS
ADD PRIMARY KEY (PERSON_ID);

-- Traduzindo o nome das colunas
ALTER TABLE DADOS_MUTUARIOS
CHANGE PERSON_ID ID_SOLICITANTE VARCHAR(16);

ALTER TABLE DADOS_MUTUARIOS
CHANGE PERSON_AGE IDADE_SOLICITANTE INT;

ALTER TABLE DADOS_MUTUARIOS
CHANGE PERSON_INCOME SALARIO_ANUAL FLOAT;

ALTER TABLE DADOS_MUTUARIOS
CHANGE PERSON_HOME_OWNERSHIP SITUACAO_PROPRIEDADE VARCHAR(10);

ALTER TABLE DADOS_MUTUARIOS
CHANGE PERSON_EMP_LENGTH ANOS_TRABALHADOS INT;

-- Traduzindo os campos da coluna SITUACAO_PROPRIEDADE

SELECT SITUACAO_PROPRIEDADE,COUNT(SITUACAO_PROPRIEDADE) FROM DADOS_MUTUARIOS
GROUP BY SITUACAO_PROPRIEDADE ORDER BY SITUACAO_PROPRIEDADE;

UPDATE DADOS_MUTUARIOS SET SITUACAO_PROPRIEDADE='Alugada'
WHERE SITUACAO_PROPRIEDADE='Rent';

UPDATE DADOS_MUTUARIOS SET SITUACAO_PROPRIEDADE='Própria'
WHERE SITUACAO_PROPRIEDADE='Own';

UPDATE DADOS_MUTUARIOS SET SITUACAO_PROPRIEDADE='Hipotecada'
WHERE SITUACAO_PROPRIEDADE='Mortgage';

UPDATE DADOS_MUTUARIOS SET SITUACAO_PROPRIEDADE='Outros'
WHERE SITUACAO_PROPRIEDADE='Other';
